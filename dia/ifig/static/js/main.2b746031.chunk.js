(this.webpackJsonpifig=this.webpackJsonpifig||[]).push([[0],{13:function(t,e,a){},15:function(t,e,a){t.exports=a(27)},21:function(t,e,a){},22:function(t,e,a){},23:function(t,e,a){},24:function(t,e,a){},27:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(11),o=a.n(i),c=(a(21),a(10)),l=a(1),s=a(2),u=a(5),h=a(4),p=a(3),d=a(6),v=a(14),f=a.n(v),y=(a(22),function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(u.a)(this,Object(h.a)(e).call(this,t))).onPatchMove=a.onPatchMove.bind(Object(p.a)(a)),a.onPortSelect=a.onPortSelect.bind(Object(p.a)(a)),a.onClick=a.onClick.bind(Object(p.a)(a)),a.onDoubleClick=a.onDoubleClick.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"onPatchMove",value:function(t,e){this.props.onPatchMove(this.props.id,{x:e.x,y:e.y})}},{key:"onPortSelect",value:function(t,e,a){if(a&&"contextmenu"===t.type)return t.preventDefault(),void this.props.onToggleStickyPort(this.props.id,e);this.props.onPortSelect(this.props.id,e,a)}},{key:"onClick",value:function(t){"contextmenu"===t.type&&(t.preventDefault(),this.props.deletePatch(this.props.id))}},{key:"onDoubleClick",value:function(t){t.preventDefault(),this.props.onPatchEdit(this.props.id)}},{key:"render",value:function(){var t=this;return r.a.createElement(f.a,{handle:".Patch-body",defaultPosition:this.props.position,onDrag:this.onPatchMove},r.a.createElement("g",null,r.a.createElement("g",{className:"Patch-body",onClick:this.onClick,onContextMenu:this.onClick,onDoubleClick:this.onDoubleClick},r.a.createElement("rect",{className:"Patch-rect",width:this.props.width,height:this.props.height,rx:"8"}),r.a.createElement("text",{className:"Patch-name",x:this.props.width/2,y:this.props.height/2,width:this.props.width-16,dominantBaseline:"middle",textAnchor:"middle"},this.props.name)),this.props.inputs.map((function(e,a){var n=t.props.stickyInputs.has(e)?" sticky":"",i=t.portY(a,t.props.inputs.length);return r.a.createElement("g",{key:e,className:"Patch-input",transform:"translate(0,".concat(i,")")},r.a.createElement("circle",{className:"Patch-port"+n,onClick:function(a){return t.onPortSelect(a,e,!0)},onContextMenu:function(a){return t.onPortSelect(a,e,!0)},"patch-id":t.props.id,"port-name":e,r:"5"}),r.a.createElement("text",{className:"Patch-port-name"+n,x:"-14",dominantBaseline:"middle",textAnchor:"end"},e))})),this.props.outputs.map((function(e,a){var n=t.portY(a,t.props.outputs.length),i=t.props.width;return r.a.createElement("g",{key:e,className:"Patch-output",transform:"translate(".concat(i,",").concat(n,")")},r.a.createElement("circle",{className:"Patch-port",onClick:function(a){return t.onPortSelect(a,e,!1)},"patch-id":t.props.id,"port-name":e,r:"5"}),r.a.createElement("text",{className:"Patch-port-name",x:"9",dominantBaseline:"middle",textAnchor:"start"},e))}))))}},{key:"portY",value:function(t,e){var a=.2*this.props.height,n=(e-1)*a;return t*a+this.props.height/2-n/2}}]),e}(r.a.Component));y.defaultProps={width:120,height:80};var m=y,k=a(8),b=(a(13),function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(u.a)(this,Object(h.a)(e).call(this,t))).onClickClose=a.onClickClose.bind(Object(p.a)(a)),a.onClickPatch=a.onClickPatch.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"onClickClose",value:function(t){t.target.classList.contains("PatchModal-container")?this.props.onClose():t.stopPropagation()}},{key:"onClickPatch",value:function(t,e){this.props.onAddPatch(e),this.props.onClose()}},{key:"render",value:function(){var t=this,e=this.props.isActive?"":"inactive";return r.a.createElement("div",{className:"PatchModal-container "+e,onClick:this.onClickClose},r.a.createElement("div",{className:"PatchModal-centered"},r.a.createElement("div",{className:"PatchModal-content"},r.a.createElement("h2",null,"New Patch"),r.a.createElement("div",{className:"PatchModal-list"},r.a.createElement("ul",null,Object(k.a)(this.props.patchRegistry.patchClasses).map((function(e){return r.a.createElement("li",{className:"PatchModal-list-item",key:e[1]},r.a.createElement("button",{onClick:function(a){return t.onClickPatch(a,e[0])}},e[1]))})))))))}}]),e}(r.a.Component)),P=a(7),g=function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(u.a)(this,Object(h.a)(e).call(this,t))).inputs={},a.onClickClose=a.onClickClose.bind(Object(p.a)(a)),a.onSubmit=a.onSubmit.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"onClickClose",value:function(t){t.target.classList.contains("PatchModal-container")?this.props.onClose():t.stopPropagation()}},{key:"onSubmit",value:function(t){t.preventDefault();var e={};for(var a in this.inputs)e[a]=this.inputs[a].current.value;this.props.onClose(this.props.patchId,e)}},{key:"render",value:function(){var t=this;if(!this.props.isActive)return null;var e=this.props.network.getPatch(this.props.patchId);for(var a in this.inputs={},e.properties)this.inputs[a]=r.a.createRef();var n=this.props.isActive?"":"inactive";return r.a.createElement("div",{className:"PatchModal-container "+n,onClick:this.onClickClose},r.a.createElement("div",{className:"PatchModal-centered"},r.a.createElement("div",{className:"PatchModal-content"},r.a.createElement("h2",null,"Edit ",e.displayName),r.a.createElement("div",{className:"PatchModal-list"},r.a.createElement("form",{onSubmit:this.onSubmit},Object.entries(e.properties).map((function(e){var a=Object(P.a)(e,2),n=a[0],i=a[1];return r.a.createElement("label",{key:n},n,":",r.a.createElement("input",{type:"text",ref:t.inputs[n],defaultValue:i}))})),r.a.createElement("input",{type:"submit",value:"Update"}))))))}}]),e}(r.a.Component);a(23);function O(t,e){var a=t.getBBox(),n=a.x,r=a.y,i=e.getBoundingClientRect(),o=t.getScreenCTM();return{x:o.a*n+o.c*r+o.e-i.left,y:o.b*n+o.d*r+o.f-i.top,width:a.width,height:a.height}}var w=function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(u.a)(this,Object(h.a)(e).call(this,t))).onClick=a.onClick.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"onClick",value:function(t){"contextmenu"===t.type&&(t.preventDefault(),this.props.deleteWire(this.props.id))}},{key:"computePathD",value:function(){var t=document.querySelector(".Patch-output [patch-id='".concat(this.props.fromPatch,"'][port-name='").concat(this.props.fromPort,"']")),e=document.querySelector(".Patch-input [patch-id='".concat(this.props.toPatch,"'][port-name='").concat(this.props.toPort,"']"));if(!t||!e)return null;var a=document.querySelector(".Workspace-doc"),n=O(t,a),r=n.x+n.width/2,i=n.y+n.height/2,o=O(e,a),c=o.x+o.width/2-10,l=o.y+o.height/2;if(c-r>-20)return"M".concat(r,",").concat(i," C").concat(r+25,",").concat(i," ").concat(c-25,",").concat(l," ").concat(c,",").concat(l);var s=c+(r-c)/2,u=Math.abs(i-l),h=Math.min(i,l)+u/2+(u<50?75:0);return"M".concat(r,",").concat(i," ")+"C".concat(r+25,",").concat(i," ").concat(r+25,",").concat(h," ").concat(s,",").concat(h," ")+"S ".concat(c-25,",").concat(l," ").concat(c,",").concat(l)}},{key:"render",value:function(){var t=this.computePathD()||"";return r.a.createElement("path",{className:"Wire-line",onClick:this.onClick,onContextMenu:this.onClick,markerEnd:"url(#head)",d:t})}}]),e}(r.a.Component);a(24);function j(t){var e=document.querySelector("svg"),a=e.createSVGPoint();return a.x=t.clientX,a.y=t.clientY,a.matrixTransform(e.getScreenCTM().inverse())}var C=function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(u.a)(this,Object(h.a)(e).call(this,t))).state=Object(c.a)({selections:{lastPort:null},ui:{activeModal:null,patchId:null,lastClickCoords:null},incompleteWire:{fromPatch:null,fromPort:null,toCoords:null},scale:1},t.network.getModel()),a.onPatchMove=a.onPatchMove.bind(Object(p.a)(a)),a.onPatchEdit=a.onPatchEdit.bind(Object(p.a)(a)),a.onPortSelect=a.onPortSelect.bind(Object(p.a)(a)),a.deleteWire=a.deleteWire.bind(Object(p.a)(a)),a.deletePatch=a.deletePatch.bind(Object(p.a)(a)),a.onOpenModal=a.onOpenModal.bind(Object(p.a)(a)),a.onCloseCreateModal=a.onCloseCreateModal.bind(Object(p.a)(a)),a.onCloseEditModal=a.onCloseEditModal.bind(Object(p.a)(a)),a.onAddPatch=a.onAddPatch.bind(Object(p.a)(a)),a.onToggleStickyPort=a.onToggleStickyPort.bind(Object(p.a)(a)),a.onExecute=a.onExecute.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"onPatchMove",value:function(t,e){var a=this;this.setState((function(n,r){return a.props.network.updatePatch(t,{position:e}),a.props.network.getModel()}))}},{key:"onPatchEdit",value:function(t){this.props.network.getPatch(t).properties&&this.setState({ui:{activeModal:"PATCH_EDIT",patchId:t}})}},{key:"onPortSelect",value:function(t,e,a){var n=this;this.setState((function(r,i){return a&&r.selections.lastPort?r.wires.find((function(a){return a.fromPatch===r.selections.lastPort.patchId&&a.fromPort===r.selections.lastPort.portName&&a.toPatch===t&&a.toPort===e}))?{selections:{lastPort:null}}:(n.props.network.addWire(r.selections.lastPort.patchId,r.selections.lastPort.portName,t,e),Object(c.a)({selections:{lastPort:null}},n.props.network.getModel())):{selections:{lastPort:{patchId:t,portName:e}}}}))}},{key:"deleteWire",value:function(t){var e=this;this.setState((function(a,n){return e.props.network.deleteWire(t),e.props.network.getModel()}))}},{key:"onOpenModal",value:function(t){this.setState({ui:{activeModal:"PATCH_CREATE",lastClickCoords:j(t)}})}},{key:"onCloseCreateModal",value:function(){this.setState({ui:{activeModal:null}})}},{key:"onCloseEditModal",value:function(t,e){var a=this;e?this.setState((function(n,r){return a.props.network.updatePatch(t,{properties:e}),Object(c.a)({ui:{activeModal:null}},a.props.network.getModel())})):this.setState({ui:{activeModal:null}})}},{key:"onAddPatch",value:function(t){var e=this,a=this.state.ui.lastClickCoords;this.setState((function(n,r){return e.props.network.addPatch(t,{position:{x:a.x-20,y:a.y-20}}),e.props.network.getModel()}))}},{key:"deletePatch",value:function(t){var e=this;this.setState((function(a,n){return e.props.network.deletePatch(t),e.props.network.getModel()}))}},{key:"onToggleStickyPort",value:function(t,e){var a=this;this.setState((function(n,r){return a.props.network.toggleStickiness(t,e),a.props.network.getModel()}))}},{key:"onExecute",value:function(){this.props.network.execute()}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"Workspace"},r.a.createElement("button",{className:"Workspace-exec-btn",onClick:this.onExecute},"Execute"),r.a.createElement(b,{patchRegistry:this.props.network.patchRegistry,isActive:"PATCH_CREATE"===this.state.ui.activeModal,onClose:this.onCloseCreateModal,onAddPatch:this.onAddPatch}),r.a.createElement(g,{patchId:this.state.ui.patchId,network:this.props.network,isActive:"PATCH_EDIT"===this.state.ui.activeModal,onClose:this.onCloseEditModal}),r.a.createElement("div",{className:"Workspace-view"},r.a.createElement("div",{className:"Workspace-surface"},r.a.createElement("svg",{className:"Workspace-doc",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("defs",null,r.a.createElement("marker",{id:"head",orient:"auto",markerWidth:"2",markerHeight:"4",refX:"0.1",refY:"2"},r.a.createElement("path",{d:"M0,0 V4 L2,2 Z",fill:"black"}))),r.a.createElement("g",{className:"Workspace-active",transform:"scale(".concat(this.state.scale,")")},r.a.createElement("rect",{className:"Workspace-background",width:"100%",height:"100%",onDoubleClick:this.onOpenModal}),this.state.wires.map((function(e){return r.a.createElement(w,Object.assign({key:e.id},e,{deleteWire:t.deleteWire}))})),this.state.patches.map((function(e){return r.a.createElement(m,Object.assign({key:e.id},e,{deletePatch:t.deletePatch,onPatchMove:t.onPatchMove,onPortSelect:t.onPortSelect,onToggleStickyPort:t.onToggleStickyPort,onPatchEdit:t.onPatchEdit}))})))))))}},{key:"componentDidMount",value:function(){this.forceUpdate()}}]),e}(r.a.Component),E=a(9),S=a.n(E),M=function(){function t(e,a,n){var r=this;Object(l.a)(this,t),this.id="".concat(S()(),"(").concat(e,")"),this.displayName=e,this.inports=new Map,a.forEach((function(t){return r.inports.set(t,new Set)})),this.outports=new Map,n.forEach((function(t){return r.outports.set(t,new Set)}))}return Object(s.a)(t,[{key:"receive",value:function(){throw new Error("Not implemented")}},{key:"execute",value:function(){if(!this.canReceive())throw new Error("Cannot receive");var t={},e=!0,a=!1,n=void 0;try{for(var r,i=this.inports[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,c=Object(P.a)(o,2),l=c[0],s=c[1],u=!0,h=!1,p=void 0;try{for(var d,v=s[Symbol.iterator]();!(u=(d=v.next()).done);u=!0){var f=d.value;if(f.canGive()){t[l]=f.give();break}}}catch(C){h=!0,p=C}finally{try{u||null==v.return||v.return()}finally{if(h)throw p}}}}catch(C){a=!0,n=C}finally{try{e||null==i.return||i.return()}finally{if(a)throw n}}var y=this.receive(t);for(var m in console.debug("Executed ".concat(this.displayName," ")+"with inports ".concat(JSON.stringify(t)," ")+"resulted in ".concat(JSON.stringify(y))),y){var k=y[m];if(void 0!==k){var b=!0,g=!1,O=void 0;try{for(var w,j=this.outports.get(m).values()[Symbol.iterator]();!(b=(w=j.next()).done);b=!0){w.value.hold(k)}}catch(C){g=!0,O=C}finally{try{b||null==j.return||j.return()}finally{if(g)throw O}}}}}},{key:"canReceive",value:function(){var t=!0,e=!1,a=void 0;try{for(var n,r=this.inports.values()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var i=n.value,o=!1,c=!0,l=!1,s=void 0;try{for(var u,h=i[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){if(u.value.canGive()){o=!0;break}}}catch(p){l=!0,s=p}finally{try{c||null==h.return||h.return()}finally{if(l)throw s}}if(!o)return!1}}catch(p){e=!0,a=p}finally{try{t||null==r.return||r.return()}finally{if(e)throw a}}return!0}},{key:"setInportStickiness",value:function(t,e){var a=!0,n=!1,r=void 0;try{for(var i,o=this.inports.get(t)[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){i.value.isSticky=e}}catch(c){n=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"addWireTo",value:function(t,e){if(!this.inports.has(t))throw new Error("No known inport ".concat(t));this.inports.get(t).add(e)}},{key:"removeWireTo",value:function(t,e){if(!this.inports.has(t))throw new Error("No known inport ".concat(t));this.inports.get(t).delete(e)}},{key:"addWireFrom",value:function(t,e){if(!this.outports.has(t))throw new Error("No known outport ".concat(t));this.outports.get(t).add(e)}},{key:"removeWireFrom",value:function(t,e){if(!this.outports.has(t))throw new Error("No known outport ".concat(t));this.outports.get(t).delete(e)}},{key:"clearInports",value:function(){var t=!0,e=!1,a=void 0;try{for(var n,r=this.inports.values()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var i=n.value,o=!0,c=!1,l=void 0;try{for(var s,u=i[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value;h.canGive()&&h.give()}}catch(p){c=!0,l=p}finally{try{o||null==u.return||u.return()}finally{if(c)throw l}}}}catch(p){e=!0,a=p}finally{try{t||null==r.return||r.return()}finally{if(e)throw a}}}}]),t}(),x=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Add",["in1","in2"],["sum"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){return{sum:t.in1+t.in2}}}]),e}(M);x.patchName="Add";var N=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Multiply",["in1","in2"],["product"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){return{product:t.in1*t.in2}}}]),e}(M);N.patchName="Multiply";var W=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Sign",["value"],["positive","zero","negative"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){var e=t.value;return e>0?{positive:e}:0===e?{zero:e}:e<0?{negative:e}:void console.error("No sign!")}}]),e}(M);W.patchName="Sign";var A=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Gate",["trigger","value"],["value"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){t.trigger;return{value:t.value}}}]),e}(M);A.patchName="Gate";var D=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Noop",["value"],["value"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){return{value:t.value}}}]),e}(M);D.patchName="Noop";var I=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Log",["message"],[]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){var e=t.message;console.log(e)}}]),e}(M);I.patchName="Log";var T=function(t){function e(){var t;return Object(l.a)(this,e),(t=Object(u.a)(this,Object(h.a)(e).call(this,"Float",[],["value"]))).properties={value:123},t.updateDisplay(),t}return Object(d.a)(e,t),Object(s.a)(e,[{key:"updateProperties",value:function(t){var e=Number.parseFloat(t.value);isNaN(e)&&(e=0),this.properties.value=e,this.updateDisplay()}},{key:"updateDisplay",value:function(){this.displayName="Float(".concat(this.properties.value,")")}},{key:"receive",value:function(){return{value:this.properties.value}}}]),e}(M);T.patchName="Float";var R=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Pop",["array"],["head","tail"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){var e=t.array;if(0!==e.length)return{head:e[0],tail:e.slice(1)}}}]),e}(M);R.patchName="Pop";var F=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,"Append",["array","elem"],["array"]))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"receive",value:function(t){var e=t.array,a=t.elem;return{array:e.concat([a])}}}]),e}(M);F.patchName="Append";var B=function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(u.a)(this,Object(h.a)(e).call(this,"js/Function",[],["result"]))).properties={functionBody:"new Date()"},a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"updateProperties",value:function(t){this.properties=t}},{key:"receive",value:function(){return{result:new Function('"use strict"; return ('.concat(this.properties.functionBody,");"))()}}}]),e}(M);B.patchName="js/Function";var G=function(){function t(e,a,n,r){Object(l.a)(this,t),this.id="".concat(S()(),"(").concat(a,":").concat(r,")"),this.fromPatch=e,this.fromOutport=a,this.toPatch=n,this.toInport=r,this.value=void 0,this.isSticky=!1}return Object(s.a)(t,[{key:"canGive",value:function(){return void 0!==this.value}},{key:"hold",value:function(t){if(void 0===t)throw new Error("Wires can't hold undefined");this.value=t}},{key:"give",value:function(){if(!this.canGive())throw new Error("Wire has nothing to give");var t=this.value;return this.isSticky||(this.value=void 0),t}}]),t}(),H=function(){function t(){Object(l.a)(this,t),this.patches=[],this.wires=new Map}return Object(s.a)(t,[{key:"addPatch",value:function(t){this.patches.push(t)}},{key:"toggleStickiness",value:function(t,e){t.setInportStickiness(e,!0)}},{key:"deletePatch",value:function(t){var e=!0,a=!1,n=void 0;try{for(var r,i=t.inports.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,c=!0,l=!1,s=void 0;try{for(var u,h=o[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var p=u.value;this.deleteWire(p.id)}}catch(E){l=!0,s=E}finally{try{c||null==h.return||h.return()}finally{if(l)throw s}}}}catch(E){a=!0,n=E}finally{try{e||null==i.return||i.return()}finally{if(a)throw n}}var d=!0,v=!1,f=void 0;try{for(var y,m=t.outports.values()[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var k=y.value,b=!0,P=!1,g=void 0;try{for(var O,w=k[Symbol.iterator]();!(b=(O=w.next()).done);b=!0){var j=O.value;this.deleteWire(j.id)}}catch(E){P=!0,g=E}finally{try{b||null==w.return||w.return()}finally{if(P)throw g}}}}catch(E){v=!0,f=E}finally{try{d||null==m.return||m.return()}finally{if(v)throw f}}var C=this.patches.indexOf(t);this.patches.splice(C,1)}},{key:"wirePatches",value:function(t,e,a,n){var r=new G(t,e,a,n);t.addWireFrom(e,r),a.addWireTo(n,r),this.wires.set(r.id,r)}},{key:"deleteWire",value:function(t){var e=this.wires.get(t);this.wires.delete(t),e.fromPatch.removeWireFrom(e.fromOutport,e),e.toPatch.removeWireTo(e.toInport,e)}},{key:"execute",value:function(){var t=[],e=!0,a=!1,n=void 0;try{for(var r,i=this.patches[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.clearInports(),o.canReceive()&&t.push(o)}}catch(O){a=!0,n=O}finally{try{e||null==i.return||i.return()}finally{if(a)throw n}}console.debug("Beginning execution with ".concat(t.length," patches"));for(var c=new Date;t.length>0;){if(new Date-c>1e4){console.warn("Execution taking longer than 10s. Halting prematurely.");break}var l=t.shift();if(l.canReceive()){l.execute();var s=!0,u=!1,h=void 0;try{for(var p,d=l.outports.values()[Symbol.iterator]();!(s=(p=d.next()).done);s=!0){var v=p.value,f=!0,y=!1,m=void 0;try{for(var k,b=v[Symbol.iterator]();!(f=(k=b.next()).done);f=!0){var P=k.value.toPatch;P.canReceive()&&t.push(P)}}catch(O){y=!0,m=O}finally{try{f||null==b.return||b.return()}finally{if(y)throw m}}}}catch(O){u=!0,h=O}finally{try{s||null==d.return||d.return()}finally{if(u)throw h}}}else console.warn("Patch ".concat(l.id," was not ready to execute."))}var g=new Date-c;console.debug("Completed execution in ".concat(g," ms"))}}]),t}(),L=new(function(){function t(e){Object(l.a)(this,t),this.patchRegistry=e,this.network=new H,this.patchMeta=new Map}return Object(s.a)(t,[{key:"addPatch",value:function(t,e){var a=new t;return this.network.addPatch(a),this.patchMeta.set(a.id,{patch:a}),this.updatePatch(a.id,e),a}},{key:"getPatch",value:function(t){return this.patchMeta.get(t).patch}},{key:"updatePatch",value:function(t,e){var a=this.patchMeta.get(t);e.properties&&a.patch.updateProperties(e.properties),e.position&&(a.position=e.position)}},{key:"toggleStickiness",value:function(t,e){var a=this.patchMeta.get(t).patch,n=!1,r=!0,i=!1,o=void 0;try{for(var c,l=a.inports.get(e)[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){if(c.value.isSticky){n=!0;break}}}catch(s){i=!0,o=s}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}a.setInportStickiness(e,!n)}},{key:"deletePatch",value:function(t){var e=this.patchMeta.get(t).patch;this.patchMeta.delete(t),this.network.deletePatch(e)}},{key:"addWire",value:function(t,e,a,n){var r=this.patchMeta.get(t).patch,i=this.patchMeta.get(a).patch;this.network.wirePatches(r,e,i,n)}},{key:"deleteWire",value:function(t){this.network.deleteWire(t)}},{key:"getModel",value:function(){var t=[],e=!0,a=!1,n=void 0;try{for(var r,i=this.patchMeta[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,c=Object(P.a)(o,2),l=c[0],s=c[1],u=this.patchMeta.get(l).patch,h=new Set,p=!0,d=!1,v=void 0;try{for(var f,y=u.inports[Symbol.iterator]();!(p=(f=y.next()).done);p=!0){var m=f.value,b=Object(P.a)(m,2),g=b[0],O=b[1],w=!0,j=!1,C=void 0;try{for(var E,S=O[Symbol.iterator]();!(w=(E=S.next()).done);w=!0){if(E.value.isSticky){h.add(g);break}}}catch(M){j=!0,C=M}finally{try{w||null==S.return||S.return()}finally{if(j)throw C}}}}catch(M){d=!0,v=M}finally{try{p||null==y.return||y.return()}finally{if(d)throw v}}t.push({id:l,name:u.displayName,inputs:Object(k.a)(u.inports.keys()),stickyInputs:h,outputs:Object(k.a)(u.outports.keys()),properties:u.properties,position:s.position})}}catch(M){a=!0,n=M}finally{try{e||null==i.return||i.return()}finally{if(a)throw n}}return{patches:t,wires:Object(k.a)(this.network.wires.values()).map((function(t){return{id:t.id,fromPatch:t.fromPatch.id,fromPort:t.fromOutport,toPatch:t.toPatch.id,toPort:t.toInport}}))}}},{key:"execute",value:function(){this.network.execute()}}]),t}())(new(function(){function t(e){var a=this;Object(l.a)(this,t),this.patchClasses=new Map,e.forEach((function(t){return a.registerPatch(t)}))}return Object(s.a)(t,[{key:"registerPatch",value:function(t){if(!t.patchName)throw new Error("Patch class should have static patchName");this.patchClasses.set(t,t.patchName)}}]),t}())([x,N,W,A,D,I,T,R,F,B]));!function(){var t=L,e=t.addPatch(T,{position:{x:65,y:181},properties:{value:-1}}),a=t.addPatch(T,{position:{x:68,y:386},properties:{value:5}}),n=t.addPatch(x,{position:{x:266,y:207}}),r=t.addPatch(N,{position:{x:306,y:395}}),i=t.addPatch(W,{position:{x:459,y:224}}),o=t.addPatch(A,{position:{x:613,y:413}}),c=t.addPatch(I,{position:{x:818,y:434}});t.addWire(e.id,"value",n.id,"in1"),t.addWire(a.id,"value",n.id,"in2"),t.addWire(n.id,"sum",i.id,"value"),t.addWire(a.id,"value",r.id,"in2"),t.addWire(i.id,"positive",n.id,"in2"),t.addWire(i.id,"positive",r.id,"in1"),t.addWire(i.id,"zero",o.id,"trigger"),t.addWire(r.id,"product",r.id,"in2"),t.addWire(r.id,"product",o.id,"value"),t.addWire(o.id,"value",c.id,"message"),t.toggleStickiness(n.id,"in1")}();var Y=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("h1",{className:"App-header"},"Ifig Editor"),r.a.createElement(C,{network:L}))};o.a.render(r.a.createElement(Y,null),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.2b746031.chunk.js.map